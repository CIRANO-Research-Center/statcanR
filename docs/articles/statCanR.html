<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>statCanR • statcanR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="statCanR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statcanR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/statCanR.html">statCanR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/warint/statcanR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>statCanR</h1>
                        <h4 class="author">Thierry Warin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/warint/statcanR/blob/master/vignettes/statCanR.Rmd"><code>vignettes/statCanR.Rmd</code></a></small>
      <div class="hidden name"><code>statCanR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(statcanR)</a></code></pre></div>
<div id="goals" class="section level1">
<h1 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h1>
<p>The goals and contributions of this paper are both methodological and thematical, namely data science technics and competitiveness thematic. This means that this paper describes the components of the <em>statcanR</em> R package allowing, throughout the using of Data Science technics, to get all Canadian statistics data (CANSIM tables) now identify by Product IDs (PID) by the new Statistics Canada Web Data Service.</p>
<p>In details, the <em>sqs_statcan_data()</em> function has 2 arguments to fulfill to get data:</p>
<ol style="list-style-type: decimal">
<li><em>tableNumber</em></li>
<li><em>lang</em></li>
</ol>
<p>The <em>tableNumber</em> argument simply referes to the table number of the Statistics Canada data table you want to collect, such as ‘<em>14-10-0287-03</em>’ for the <em>Labour force characteristics by province, monthly, seasonally adjusted</em> as an example.</p>
<p>The second argument, <em>lang</em>, referes to the language. As Canada is a billingual country (french speaking in Quebec and english speaking in the other provinces), Statistics Canada display all Statistics Data in both languages. Therefore, users can choose if they want to get satistics data table in french or english by seting the <em>lang</em> argument by c(“fra”, “eng”).</p>
<p>The global process of the <em>sqs_statcan_data()</em> function:</p>
<p>First, clean the table number in order to align it with the official complete table number typology of Statistic Canada Web Data Service. Second, create a temporary folder where all the next operations can be done. Third, check and select the correct language asked by the user. Fourth, define the correct ‘url’ where statistic data table is stored and download the <em>.Zip</em> file from it. Fifth, unzip the previous downloaded <em>.Zip</em> file to get the data and meta data <em>.csv</em> files. Sixth, load the statistics data into a data frame called ‘<em>data</em>’ and add the official table indicator name in the new ‘<em>INDICATOR</em>’ column.</p>
<p>To go deeper in the <em>sqs_statcan_data()</em> function treatment, here is below a line-by-line of code description:</p>
<ul>
<li><p><code>tableNumber &lt;- gsub("-", "", substr(tableNumber, 1, nchar(tableNumber)-2))</code>: The first action the function make is to clean the table number gave by user in order to be able to get the complete data table related to the specific indicator the user are looking for. In fact, each Statistics Canada data web page display is an excerpt of the one complete table. In addition, following the Statistics Canada Web Data Service, the url typology defined for the REST API is to stocked csv file by table number without ‘-’. Also, the 2 last digit after the last ‘-’ indicates the specific excerpt of the original complete table. Therefore, following the Statistics Canada Web Data Service typology, the function first remove the ‘-’ and the 2 last digits from the user function input.</p></li>
<li><p><code>if(lang == "eng")</code> | <code>if(lang == "fra")</code>: The second applying is the ‘<em>if statement</em>’ to get the data in the correct language.</p></li>
<li><p><code>urlFra &lt;- paste0("https://www150.statcan.gc.ca/n1/fr/tbl/csv/", tableNumber, "-fra.zip")</code>: The third applying is the creation of the correct url in order to download the correct <em>.Zip</em> file from the Statistics Canada Web Data Service.</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/download.file.html">download.file(urlEng, destfile=paste0(path,"/temp/datasetEng.zip"), method="curl")</a></code>: The fourth applying is a simple downloading function that extract <em>.Zip</em> file and download it into the temporary folder create at the beginning.</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/unzip.html">unzip(paste0(path, "/temp/datasetEng.zip"), exdir = paste0(path,"/temp"))</a></code>: The fifth applying consist to unzip the <em>.Zip</em> file downaloaded at the last step. The unzip process give an access to two diffrent <em>.csv</em> files, such as the statistics data table and the meta data table.</p></li>
<li><p><code>data &lt;- fread(paste0(path,"/temp/", tableNumber, ".csv"))</code>: The sixth applying consist to load the statistics data table into a unique data frame. We decide to use the function <em>fread</em> from the <em>data.table</em> package due to the better applied function speed.</p></li>
<li><p><code>data$INDICATOR &lt;- as.character(0)</code> and <code>data$INDICATOR &lt;- as.character(read.csv(paste0(path,"/temp/", tableNumber, "_MetaData.csv"))[1,1])</code>: The seventh applying of the <em>sqs_statcan_data()</em> function consist to add the name of the table extract from the meta data table.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/unlink.html">unlink(paste0(path,"/temp/"), recursive = TRUE)</a></code>: The heighth applying allow to remove and delete the temporary folder used to download, unzip, extract and load data for a unique using of the function.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/function.html">return(data)</a></code>: Finally, the last line of the <em>sqs_statcan_data()</em> function allows to return the value of the function treatment into the IDE.</p></li>
</ul>
</div>
<div id="practical-usage" class="section level1">
<h1 class="hasAnchor">
<a href="#practical-usage" class="anchor"></a>Practical usage</h1>
<p>This section presents an example of how to use the <em>statcanR</em> R package and its function <em>sqs_statcan_data()</em>.</p>
<p>The example is provided to illustrate how to use the function as well as understand and know more about the Canadian labour force wages in terms of competitiveness and attractiveness theme. Therefore, it consists in collecting descriptive statistics about the Canadian Labour Force characteristics at a country and provincial levels, as well as based on a monthly frequency.</p>
<p>With a simple web search ‘<em>statistics canada wages by industry metropolitan area monthly</em>’, you can easily find the table number of the satistics you are looking for on the Statisitcs Canada data web page. Here is below a figure that illustrates this example, such as ‘<em>14-10-0063-01</em>’ for the <em>Employee wages by industry, monthly, unadjusted for seasonality at a country and provinces level</em>.</p>
<p>Once you have the table number, you can easily used the <em>sqs_statcan_data()</em> function to collect the data, as following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Get data with sqs_statcan_data function</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">dt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sqs_statcan_data.html">sqs_statcan_data</a></span>(<span class="st">"14-10-0063-01"</span>, <span class="st">"eng"</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#goals">Goals</a></li>
      <li><a href="#practical-usage">Practical usage</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thierry Warin, Romain Le Duc.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
